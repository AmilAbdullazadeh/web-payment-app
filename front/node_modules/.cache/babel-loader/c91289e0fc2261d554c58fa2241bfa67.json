{"ast":null,"code":"import _slicedToArray from\"/Users/amilabdullayev/Desktop/Projects/web-payment-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,useContext}from\"react\";import{Col,Container,Form,Row,Button}from\"react-bootstrap\";import Message from\"../components/Message\";import Receipt from\"../components/Receipt\";import{CategoryListContext}from\"../contexts/CategoryListContext\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function FormScreen(_ref){var match=_ref.match,history=_ref.history;var categoryId=match.params.categoryId;var providerId=match.params.providerId;var _useState=useState(),_useState2=_slicedToArray(_useState,2),field=_useState2[0],setField=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),providers=_useState4[0],setProviders=_useState4[1];var _useState5=useState(true),_useState6=_slicedToArray(_useState5,2),loading=_useState6[0],setLoading=_useState6[1];var _useState7=useState(null),_useState8=_slicedToArray(_useState7,2),error=_useState8[0],setError=_useState8[1];// form\nvar _useState9=useState(''),_useState10=_slicedToArray(_useState9,2),number=_useState10[0],setNumber=_useState10[1];var _useState11=useState(''),_useState12=_slicedToArray(_useState11,2),exp_month=_useState12[0],setExpMonth=_useState12[1];var _useState13=useState(''),_useState14=_slicedToArray(_useState13,2),exp_year=_useState14[0],setExpYear=_useState14[1];var _useState15=useState(''),_useState16=_slicedToArray(_useState15,2),cvv=_useState16[0],setCvv=_useState16[1];var _useState17=useState(''),_useState18=_slicedToArray(_useState17,2),value=_useState18[0],setValue=_useState18[1];var _useState19=useState(''),_useState20=_slicedToArray(_useState19,2),currency=_useState20[0],setCurrency=_useState20[1];var _useState21=useState({}),_useState22=_slicedToArray(_useState21,2),datas=_useState22[0],setDatas=_useState22[1];var _useState23=useState(false),_useState24=_slicedToArray(_useState23,2),validated=_useState24[0],setValidated=_useState24[1];var _useState25=useState(false),_useState26=_slicedToArray(_useState25,2),isSubmit=_useState26[0],setIsSubmit=_useState26[1];var _useState27=useState({}),_useState28=_slicedToArray(_useState27,2),dataRequest=_useState28[0],setDataRequest=_useState28[1];var _useState29=useState({}),_useState30=_slicedToArray(_useState29,2),dataReceipt=_useState30[0],setDataReceipt=_useState30[1];var _useState31=useState(false),_useState32=_slicedToArray(_useState31,2),showReceipt=_useState32[0],setShowReceipt=_useState32[1];// context api\nvar categoryList=useContext(CategoryListContext);useEffect(function(){try{//  check local storage data\nvar localData=JSON.parse(localStorage.getItem('receiptStorage'));if(localData!==undefined&&localData!==null){setIsSubmit(true);setShowReceipt(true);setDataReceipt(localData);}var categoryFiltered=categoryList.filter(function(category){return category.id===categoryId;});var providerFiltered=providers.filter(function(provider){return provider.id===providerId;});setProviders(categoryFiltered[0].providers);setField(providerFiltered[0]);}catch(error){console.error(error);setError(error);}finally{setLoading(false);}},[loading,error,isSubmit,showReceipt]);var fieldChanged=function fieldChanged(key,value){setDatas(function(currentValues){currentValues[key]=value;return currentValues;});// for (const [key, value] of Object.entries(datas)) {\n//     setKeyData(currentValues => {\n//         currentValues = {\n//             k: currentValues[key],\n//             v: value\n//         }\n//         return currentValues;\n//     });\n// }\n// console.info('keyData', keyData);\n};var handleSubmit=function handleSubmit(event){setIsSubmit(true);var form=event.currentTarget;if(form.checkValidity()===false){event.preventDefault();event.stopPropagation();}else{event.preventDefault();var data=[{providerId:providerId,fields:datas,amount:{value:value,currency:currency},card:{number:number,exp_month:exp_month,exp_year:exp_year,cvv:cvv}}];setDataRequest(data);// for generate id\nvar generateRandomString=function generateRandomString(){var length=arguments.length>0&&arguments[0]!==undefined?arguments[0]:10;return Math.random().toString(20).substr(2,length);};var randomId=generateRandomString(200);// yyyy-MM-ddTHH:mm:ss\nvar date_ob=new Date();// adjust 0 before single digit date\nvar date=(\"0\"+date_ob.getDate()).slice(-2);// current month\nvar month=(\"0\"+(date_ob.getMonth()+1)).slice(-2);// current year\nvar year=date_ob.getFullYear();// current hours\nvar hours=date_ob.getHours();// current minutes\nvar minutes=date_ob.getMinutes();// current seconds\nvar seconds=date_ob.getSeconds();var dateNow=\"\".concat(year,\"-\").concat(month,\"-\").concat(date,\"T\").concat(hours,\":\").concat(minutes,\":\").concat(seconds);var receipt={id:randomId,date:dateNow,details:datas,amount:{value:value,currency:currency}};setDataReceipt(receipt);// local storage\nlocalStorage.setItem('receiptStorage',JSON.stringify(receipt));// eslint-disable-next-line no-unused-expressions\ndataReceipt!==undefined&&dataRequest!==undefined?setShowReceipt(true):setShowReceipt(false);}setValidated(true);};var handleBack=function handleBack(){var localeData=JSON.parse(localStorage.getItem('receiptStorage'));if(localeData!==undefined||true){localStorage.removeItem('receiptStorage');setIsSubmit(false);setShowReceipt(false);}history.push('/');};if(loading)return\"Loading...\";if(error)return/*#__PURE__*/_jsx(Message,{variant:\"danger\",children:error});return/*#__PURE__*/_jsxs(Container,{children:[/*#__PURE__*/_jsx(Button,{onClick:handleBack,className:\"btn btn-light my-3\",children:\"Go back\"}),isSubmit&&showReceipt?/*#__PURE__*/_jsx(Receipt,{dataReceipt:dataReceipt}):/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Form,{noValidate:true,validated:validated,onSubmit:handleSubmit,children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{sm:12,md:6,lg:4,xl:4,children:/*#__PURE__*/_jsxs(\"div\",{className:\"card-container\",children:[field&&field.fields.map(function(f,idx){return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-2\",children:[/*#__PURE__*/_jsx(Form.Label,{children:f.label}),f.type===4?/*#__PURE__*/_jsxs(Form.Control,{name:f.id,as:\"select\",required:true,onChange:function onChange(e){return fieldChanged(f.id,e.target.value);},children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select...\"}),f.options.map(function(option){return/*#__PURE__*/_jsx(\"option\",{value:option.v,children:option.v},option.id);})]}):/*#__PURE__*/_jsx(Form.Control,{required:true,name:f.id,type:f.type===1?'text':f.type===2&&f.id!=='phone_number'||f.type===3&&f.id!=='phone_number'?'number':f.type===5?'date':'text',placeholder:f.label,maxLength:f.id==='phone_number'?7:55,onChange:function onChange(e){return fieldChanged(f.id,e.target.value);}})]})},idx);}),/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-2\",controlId:\"value\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Amount\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"text\",placeholder:\"Amount\",required:true,value:value,onChange:function onChange(e){return setValue(e.target.value);}})]}),/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-2\",controlId:\"currency\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Currency\"}),/*#__PURE__*/_jsxs(Form.Control,{as:\"select\",required:true,value:currency,onChange:function onChange(e){return setCurrency(e.target.value);},children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select...\"}),/*#__PURE__*/_jsx(\"option\",{value:\"USD\",children:\"USD\"})]})]})]})}),/*#__PURE__*/_jsx(Col,{sm:12,md:6,lg:8,xl:5,children:/*#__PURE__*/_jsxs(\"div\",{className:\"card-container\",children:[/*#__PURE__*/_jsx(Col,{sm:12,md:12,lg:12,xl:12,children:/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-2\",controlId:\"number\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Card number\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"text\",placeholder:\"Card number\",required:true,className:\"cardNumber\",value:number,maxLength:\"19\",onChange:function onChange(e){return setNumber(e.target.value);}})]})}),/*#__PURE__*/_jsx(Col,{sm:12,md:12,lg:12,xl:12,children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsxs(Col,{sm:12,md:8,lg:6,xl:6,children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Exp date\"}),/*#__PURE__*/_jsxs(Form.Group,{className:\"exp mb-2\",controlId:\"exp_month\",children:[/*#__PURE__*/_jsx(Form.Control,{type:\"text\",placeholder:\"ExpMonth\",required:true,className:\"exp-left\",value:exp_month,maxLength:\"2\",onChange:function onChange(e){return setExpMonth(e.target.value);}}),/*#__PURE__*/_jsx(\"span\",{className:\"exp-line\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"text\",placeholder:\"ExpYear\",required:true,className:\"exp-right\",value:exp_year,maxLength:\"2\",onChange:function onChange(e){return setExpYear(e.target.value);}})]})]}),/*#__PURE__*/_jsx(Col,{sm:12,md:8,lg:6,xl:6,children:/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-2\",controlId:\"cvv\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"CVV\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"text\",placeholder:\"CVV\",required:true,className:\"cvv\",value:cvv,maxLength:\"3\",onChange:function onChange(e){return setCvv(e.target.value);}})]})})]})}),/*#__PURE__*/_jsx(Col,{sm:12,md:12,lg:12,xl:12,children:/*#__PURE__*/_jsx(Button,{className:\"submitButton\",variant:\"primary\",type:\"submit\",children:\"Submit\"})})]})})]})})})]});}export default FormScreen;","map":{"version":3,"sources":["/Users/amilabdullayev/Desktop/Projects/web-payment-app/src/screens/FormScreen.jsx"],"names":["React","useState","useEffect","useContext","Col","Container","Form","Row","Button","Message","Receipt","CategoryListContext","FormScreen","match","history","categoryId","params","providerId","field","setField","providers","setProviders","loading","setLoading","error","setError","number","setNumber","exp_month","setExpMonth","exp_year","setExpYear","cvv","setCvv","value","setValue","currency","setCurrency","datas","setDatas","validated","setValidated","isSubmit","setIsSubmit","dataRequest","setDataRequest","dataReceipt","setDataReceipt","showReceipt","setShowReceipt","categoryList","localData","JSON","parse","localStorage","getItem","undefined","categoryFiltered","filter","category","id","providerFiltered","provider","console","fieldChanged","key","currentValues","handleSubmit","event","form","currentTarget","checkValidity","preventDefault","stopPropagation","data","fields","amount","card","generateRandomString","length","Math","random","toString","substr","randomId","date_ob","Date","date","getDate","slice","month","getMonth","year","getFullYear","hours","getHours","minutes","getMinutes","seconds","getSeconds","dateNow","receipt","details","setItem","stringify","handleBack","localeData","removeItem","push","map","f","idx","label","type","e","target","options","option","v"],"mappings":"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","sourcesContent":["import React, {useState, useEffect, useContext} from \"react\";\nimport {Col, Container, Form, Row, Button} from \"react-bootstrap\";\nimport Message from \"../components/Message\";\nimport Receipt from \"../components/Receipt\";\nimport {CategoryListContext} from \"../contexts/CategoryListContext\";\n\nfunction FormScreen({match, history}) {\n\n    const categoryId = match.params.categoryId;\n    const providerId = match.params.providerId;\n\n    const [field, setField] = useState();\n    const [providers, setProviders] = useState([]);\n    const [loading, setLoading] = useState(true);\n    const [error, setError] = useState(null);\n\n    // form\n    const [number, setNumber] = useState('');\n    const [exp_month, setExpMonth] = useState('');\n    const [exp_year, setExpYear] = useState('');\n    const [cvv, setCvv] = useState('');\n\n    const [value, setValue] = useState('');\n    const [currency, setCurrency] = useState('');\n\n    const [datas, setDatas] = useState({})\n\n    const [validated, setValidated] = useState(false);\n\n    const [isSubmit, setIsSubmit] = useState(false);\n\n    const [dataRequest, setDataRequest] = useState({});\n    const [dataReceipt, setDataReceipt] = useState({});\n\n    const [showReceipt, setShowReceipt] = useState(false);\n\n    // context api\n    const categoryList = useContext(CategoryListContext);\n\n    useEffect(() => {\n        try {\n            //  check local storage data\n            const localData = JSON.parse(localStorage.getItem('receiptStorage'));\n            \n            if (localData !== undefined && localData !== null) {\n                setIsSubmit(true);\n                setShowReceipt(true);\n                setDataReceipt(localData);\n            }\n\n            const categoryFiltered = categoryList.filter(category => category.id === categoryId);\n            const providerFiltered = providers.filter(provider => provider.id === providerId);\n\n            setProviders(categoryFiltered[0].providers);\n            setField(providerFiltered[0]);\n        } catch (error) {\n            console.error(error);\n            setError(error);\n        } finally {\n            setLoading(false);\n        }\n    }, [loading, error, isSubmit, showReceipt]);\n\n    const fieldChanged = (key, value) => {\n        setDatas(currentValues => {\n            currentValues[key] = value;\n            return currentValues;\n        });\n\n        // for (const [key, value] of Object.entries(datas)) {\n        //     setKeyData(currentValues => {\n        //         currentValues = {\n        //             k: currentValues[key],\n        //             v: value\n        //         }\n        //         return currentValues;\n        //     });\n        // }\n\n        // console.info('keyData', keyData);\n    }\n\n    const handleSubmit = (event) => {\n        setIsSubmit(true);\n        const form = event.currentTarget;\n        if (form.checkValidity() === false) {\n            event.preventDefault();\n            event.stopPropagation();\n        } else {\n            event.preventDefault();\n\n            const data = [\n                {\n                    providerId: providerId,\n                    fields: datas,\n                    amount: {\n                        value: value,\n                        currency: currency\n                    },\n                    card: {\n                        number: number,\n                        exp_month: exp_month,\n                        exp_year: exp_year,\n                        cvv: cvv\n                    }\n                }\n            ]\n\n            setDataRequest(data);\n\n            // for generate id\n            const generateRandomString = (length = 10) => Math.random().toString(20).substr(2, length)\n            let randomId = generateRandomString(200);\n\n            // yyyy-MM-ddTHH:mm:ss\n            let date_ob = new Date();\n            // adjust 0 before single digit date\n            let date = (\"0\" + date_ob.getDate()).slice(-2);\n            // current month\n            let month = (\"0\" + (date_ob.getMonth() + 1)).slice(-2);\n            // current year\n            let year = date_ob.getFullYear();\n            // current hours\n            let hours = date_ob.getHours();\n            // current minutes\n            let minutes = date_ob.getMinutes();\n            // current seconds\n            let seconds = date_ob.getSeconds();\n\n            const dateNow = `${year}-${month}-${date}T${hours}:${minutes}:${seconds}`;\n\n            const receipt = {\n                id: randomId,\n                date: dateNow,\n                details: datas,\n                amount: {\n                    value: value,\n                    currency: currency\n                }\n            }\n\n            setDataReceipt(receipt);\n\n            // local storage\n            localStorage.setItem('receiptStorage', JSON.stringify(receipt));\n\n            // eslint-disable-next-line no-unused-expressions\n            dataReceipt !== undefined && dataRequest !== undefined ? setShowReceipt(true) : setShowReceipt(false);\n\n        }\n        setValidated(true);\n    };\n\n    const handleBack = () => {\n        const localeData = JSON.parse(localStorage.getItem('receiptStorage'));\n\n        if (localeData !== undefined || true) {\n            localStorage.removeItem('receiptStorage');\n            setIsSubmit(false);\n            setShowReceipt(false);\n        }\n\n        history.push('/');\n    }\n\n    if (loading) return \"Loading...\";\n    if (error) return <Message variant=\"danger\">{error}</Message>\n\n    return (\n        <Container>\n            <Button onClick={handleBack} className=\"btn btn-light my-3\">\n                Go back\n            </Button>\n            {\n                (isSubmit && showReceipt) ? <Receipt dataReceipt={dataReceipt}/>\n                    : (\n                        <div>\n                            <Form noValidate validated={validated} onSubmit={handleSubmit}>\n                                <Row>\n                                    <Col sm={12} md={6} lg={4} xl={4}>\n                                        <div className=\"card-container\">\n                                            {field && field.fields.map((f, idx) => (\n                                                <div key={idx}>\n                                                    <Form.Group className=\"mb-2\">\n                                                        <Form.Label>{f.label}</Form.Label>\n                                                        {\n                                                            f.type === 4 ?\n                                                                (\n                                                                    <Form.Control\n                                                                        name={f.id}\n                                                                        as=\"select\"\n                                                                        required\n                                                                        onChange={(e) => fieldChanged(f.id, e.target.value)}\n                                                                    >\n                                                                        <option value=\"\">Select...</option>\n                                                                        {\n                                                                            f.options.map((option) => (\n                                                                                <option\n                                                                                    key={option.id}\n                                                                                    value={option.v}\n                                                                                >\n                                                                                    {option.v}\n                                                                                </option>\n                                                                            ))\n                                                                        }\n                                                                    </Form.Control>\n                                                                )\n                                                                : (\n                                                                    <Form.Control\n                                                                        required\n                                                                        name={f.id}\n                                                                        type={f.type === 1 ? 'text' : (f.type === 2 && f.id !== 'phone_number') || (f.type === 3 && f.id !== 'phone_number') ? 'number' : f.type === 5 ? 'date' : 'text'}\n                                                                        placeholder={f.label}\n                                                                        maxLength={f.id === 'phone_number' ? 7 : 55}\n                                                                        onChange={(e) => fieldChanged(f.id, e.target.value)}\n                                                                    />\n                                                                )\n                                                        }\n                                                    </Form.Group>\n                                                </div>\n                                            ))}\n                                            <Form.Group className=\"mb-2\" controlId=\"value\">\n                                                <Form.Label>Amount</Form.Label>\n                                                <Form.Control\n                                                    type=\"text\"\n                                                    placeholder=\"Amount\"\n                                                    required\n                                                    value={value}\n                                                    onChange={(e) => setValue(e.target.value)}\n                                                />\n                                            </Form.Group>\n                                            <Form.Group className=\"mb-2\" controlId=\"currency\">\n                                                <Form.Label>Currency</Form.Label>\n                                                <Form.Control\n                                                    as=\"select\"\n                                                    required\n                                                    value={currency}\n                                                    onChange={(e) => setCurrency(e.target.value)}\n                                                >\n                                                    <option value=\"\">Select...</option>\n                                                    <option value=\"USD\">USD</option>\n                                                </Form.Control>\n                                            </Form.Group>\n                                        </div>\n                                    </Col>\n                                    <Col sm={12} md={6} lg={8} xl={5}>\n                                        <div className=\"card-container\">\n                                            <Col sm={12} md={12} lg={12} xl={12}>\n                                                <Form.Group className=\"mb-2\" controlId=\"number\">\n                                                    <Form.Label>Card number</Form.Label>\n                                                    <Form.Control\n                                                        type=\"text\"\n                                                        placeholder=\"Card number\"\n                                                        required\n                                                        className=\"cardNumber\"\n                                                        value={number}\n                                                        maxLength=\"19\"\n                                                        onChange={(e) => setNumber(e.target.value)}\n                                                    />\n                                                </Form.Group>\n                                            </Col>\n                                            <Col sm={12} md={12} lg={12} xl={12}>\n                                                <Row>\n                                                    <Col sm={12} md={8} lg={6} xl={6}>\n                                                        <Form.Label>Exp date</Form.Label>\n                                                        <Form.Group className=\"exp mb-2\" controlId=\"exp_month\">\n                                                            <Form.Control\n                                                                type=\"text\"\n                                                                placeholder=\"ExpMonth\"\n                                                                required\n                                                                className=\"exp-left\"\n                                                                value={exp_month}\n                                                                maxLength=\"2\"\n                                                                onChange={(e) => setExpMonth(e.target.value)}\n                                                            />\n                                                            <span className=\"exp-line\"/>\n                                                            <Form.Control\n                                                                type=\"text\"\n                                                                placeholder=\"ExpYear\"\n                                                                required\n                                                                className=\"exp-right\"\n                                                                value={exp_year}\n                                                                maxLength=\"2\"\n                                                                onChange={(e) => setExpYear(e.target.value)}\n                                                            />\n                                                        </Form.Group>\n                                                    </Col>\n                                                    <Col sm={12} md={8} lg={6} xl={6}>\n                                                        <Form.Group className=\"mb-2\" controlId=\"cvv\">\n                                                            <Form.Label>CVV</Form.Label>\n                                                            <Form.Control\n                                                                type=\"text\"\n                                                                placeholder=\"CVV\"\n                                                                required\n                                                                className=\"cvv\"\n                                                                value={cvv}\n                                                                maxLength=\"3\"\n                                                                onChange={(e) => setCvv(e.target.value)}\n                                                            />\n                                                        </Form.Group>\n                                                    </Col>\n                                                </Row>\n                                            </Col>\n                                            <Col sm={12} md={12} lg={12} xl={12}>\n                                                <Button className='submitButton' variant=\"primary\" type=\"submit\">\n                                                    Submit\n                                                </Button>\n                                            </Col>\n                                        </div>\n                                    </Col>\n                                </Row>\n                            </Form>\n                        </div>\n                    )\n            }\n        </Container>\n    );\n}\n\nexport default FormScreen;\n"]},"metadata":{},"sourceType":"module"}